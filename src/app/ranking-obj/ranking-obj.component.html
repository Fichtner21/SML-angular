

<ng-container *ngIf="lastWarOfPlayer$ | async as lastWarOfPlayers">
  <ng-container *ngIf="lastWarOfPlayers.length > 0">
    <section class="example">
      <div class="container">
        <div class="cont">        
          <div class="ranking-head">
            <div class="">{{ 'ranking.place' | translate }}</div>
            <div class="">{{ 'ranking.player_name' | translate }}</div>
            <div class=""></div>
            <div class="ranking" (click)="booleanVarRank ? sortByRankingAsc(lastWarOfPlayer$) : sortByRankingDesc(lastWarOfPlayer$)" title="sort by Ranking">Ranking

              <!-- <ng-container *ngIf="booleanVarRank; then upRank; else downRank"></ng-container>
              <ng-template #upRank>
                <fa-icon [icon]="arrowUp"></fa-icon>
              </ng-template>
              <ng-template #downRank>
                <fa-icon [icon]="arrowDown"></fa-icon>
              </ng-template> -->

            </div>
            <!-- <div class="fpw" title="sort by Frags per War" (click)="booleanVarFpW ? sortByFpWAsc(lastWarOfPlayer$) : sortByFpWDesc(lastWarOfPlayer$)">
              FpW
            </div> -->
            <div style="display: block;">              
              <div class="fpw" (click)="booleanVarS1Fpw ? sortByS1FpwAsc(lastWarOfPlayer$) : sortByS1FpwDesc(lastWarOfPlayer$)" title="sort by Frags per War in Season #3: 01-10-2023 - 31-12-2023">s4 FpW<span></span></div>
              <div class="s1wars" *ngIf="isInfo" (click)="booleanVarFpW ? sortByFpWAsc(lastWarOfPlayer$) : sortByFpWDesc(lastWarOfPlayer$)" title="sort by Frags per War">FpW total:</div>
            </div>
            <div style="display:block;">              
              <div class="wars" (click)="booleanVarS1Wars ? sortByS1WarsAsc(lastWarOfPlayer$) : sortByS1WarsDesc(lastWarOfPlayer$)" title="sort by Wars in Season #3: 01-10-2023 - 31-12-2023">s4 Wars<span></span></div>
              <div class="s1wars" *ngIf="isInfo" (click)="booleanVar ? sortByWarsAsc(lastWarOfPlayer$) : sortByWarsDesc(lastWarOfPlayer$)" title="sort by Wars">{{ 'ranking.wars' | translate }} total:</div>
            </div> 
                <!-- <ng-container *ngIf="booleanVar; then up; else down"></ng-container>
                <ng-template #up>
                  <fa-icon [icon]="arrowUp"></fa-icon>
                </ng-template>
                <ng-template #down>
                  <fa-icon [icon]="arrowDown"></fa-icon>
                </ng-template> -->
            <div class="new-head">{{ 'ranking.last_war' | translate }}</div>
            <div class="">{{ 'ranking.act' | translate }}</div>
          </div> 
          <div class="players-list">
            <ng-container *ngFor="let player of lastWarOfPlayers; let i = index;">
              <!-- <ng-container *ngIf="player.ban"> -->
                <div class="character-card" [ngClass]="{'goldie': i == 0, 'silverie': i == 1, 'brownie': i == 2 }" *ngIf="player.inactive && !player.ban" (dataEvent)="handleData($event)">                
                  <div class="item item-place" 
                 
                  >
                  {{ i+1 }}</div>
                  <div class="playername-cont" [ngClass]="{'over1000': (player.wars > 1000)}">
                    <div class="wars-bar" *ngIf="isInfo" title="Exp. rank" [style.width.%]="getPercentage(player.wars)" [ngClass]="getBarColor(player.wars)"></div>
                    <div class="wars-bar" *ngIf="!isInfo"></div>
                    <a routerLink="/obj-ranking/{{player.username}}" class=" playername" [title]="player.username === 'zielony'
                    ? 'Winner s3'
                    : player.username === 'Cronic'
                        ? '2nd in s3'
                        : player.username === 'boogie'
                            ? '3rd in s3'
                            : ''">
                    {{ player.playername }}
                    <!-- <div [ngClass]="{ 'up-streak': player.strike > 0, 'down-streak': player.strike < 0, 'draw-streak': player.strike == 0 }">
                      <span attr.data-title="{{player.strike}} in Last war.
                                            
                      "></span>
                       <span *ngIf="player.s1wars_win != 'NaN'" attr.data-title="{{ player.s1wars_win }} place in wars S#1"></span>
                      <span *ngIf="player.s1fpw_win != 'NaN'" attr.data-title="{{ player.s1fpw_win }} place in FpW S#1"></span>
                      <span *ngIf="player.s1ranking_win != 'NaN'" attr.data-title="{{ player.s1ranking_win }} rank in S#1"></span>
                    </div>    -->
                    <div class="up-down-strike" title="pc in last war" [ngClass]="{ 'up-streak-name': player.strike > 0, 'down-streak-name': player.strike < 0, 'draw-streak-name': player.strike == 0 }">
                      <ng-container *ngIf="player.strike > 0">
                        <fa-icon [icon]="arrowUp"></fa-icon>
                      </ng-container>
                      <ng-container *ngIf="player.strike < 0">
                        <fa-icon [icon]="arrowDown"></fa-icon>
                      </ng-container>
                      <ng-container *ngIf="player.strike == 0">
                        <fa-icon [icon]="arrowMinus"></fa-icon>
                      </ng-container>
                      {{player.strike}}
                      <sub>pc</sub>
                    </div> 

                    <ng-container *ngIf="i == 0">
                      <img [src]='"assets/images/ladder1.gif"'>
                    </ng-container>
                    <ng-container *ngIf="i == 1">
                      <img [src]='"assets/images/ladder2.gif"'>
                    </ng-container>
                    <ng-container *ngIf="i == 2">
                      <img [src]='"assets/images/ladder3.gif"'>
                    </ng-container>
                    <ng-container *ngIf="player.s3ranking_win === 1">                      
                      <fa-icon [icon]="number1" class="number number1"></fa-icon>
                    </ng-container>
                    <ng-container *ngIf="player.s3ranking_win === 2">                      
                      <fa-icon [icon]="number2" class="number number2"></fa-icon>
                    </ng-container>
                    <ng-container *ngIf="player.s3ranking_win === 3">                      
                      <fa-icon [icon]="number3" class="number number3"></fa-icon>
                    </ng-container>

                    <!-- <ng-container *ngIf="(player.s2wars_win === 1 || player.s2fpw_win === 1 || player.s2ranking_win === 1)">
                      <fa-icon [icon]="number1" class="number number1"></fa-icon>
                    </ng-container>
                    <ng-container *ngIf="(player.s2wars_win !== 1 && player.s2fpw_win !== 1 && player.s2ranking_win !== 1) && (player.s2wars_win && player.s2fpw_win && player.s2ranking_win)">
                      <fa-icon [icon]="number3" class="number number3"></fa-icon>
                    </ng-container>
                    <ng-container *ngIf="(player.s2wars_win === 2 || player.s2fpw_win === 2 || player.s2ranking_win === 2)">
                      <fa-icon [icon]="number2" class="number number2"></fa-icon>
                    </ng-container>
                    <ng-container *ngIf="(player.s2wars_win === 3 || player.s2fpw_win === 3 || player.s2ranking_win === 3) && !(player.s2wars_win === 2 || player.s2fpw_win === 2 || player.s2ranking_win === 2) && !(player.s2wars_win === 1 || player.s2fpw_win === 1 || player.s2ranking_win === 1)">
                      <fa-icon [icon]="number3" class="number number3"></fa-icon>
                    </ng-container> -->
                    <!--  -->

                    <!-- <ng-container *ngIf="player.username === 'zielony'">
                      <fa-icon [icon]="number3" class="number number3"></fa-icon>
                    </ng-container>
                     -->                     
                  </a>   
                  <!-- <div *ngIf="i === 0 && player.streak" class="streak-small" title="1st place since">
                    <span>since:</span> {{ player.streak }}
                  </div>            -->
                  </div>
                  <div class="item">
                    <img [src]='"assets/images/flags_svg/" + player.flag + ".SVG"'>
                  </div>
                  <div class="item">{{ player.ranking | number: '.2-2' }}</div>
                 
                  <div class="item item-block fpw" title="MAX: {{ player.maxfragsperwar }} MIN: {{ player.minfragsperwar }}">
                    <div title="Season FpW" *ngIf="!isInfo">{{ player.s4fpw }}</div>
                    <div title="Season FpW" *ngIf="isInfo" [ngClass]="{'up-streak-pre': (player.s4fpw > player.fragsperwar), 'draw-streak-pre': (player.s4fpw == player.fragsperwar), 'down-streak-pre': (player.s4fpw < player.fragsperwar)}">{{ player.s4fpw }}</div>
                
                    <div class="season-wars" *ngIf="isInfo" [ngClass]="{'up-streak-post': (player.s4fpw < player.fragsperwar), 'draw-streak-post': (player.s4fpw == player.fragsperwar), 'down-streak-post': (player.s4fpw > player.fragsperwar)}"> <span title="Total FpW">{{ player.fragsperwar }}</span></div>
                </div>
                
                  <!-- <div class="item-block" title="MAX: {{ player.maxfragsperwar }} MIN: {{ player.minfragsperwar }}">
                    <div title="Season FpW" *ngIf="!isInfo">{{ player.s1fpw }}</div>
                    <div title="Season FpW" *ngIf="isInfo" [ngClass]="{'up-streak-pre': (player.s1fpw > player.fragsperwar), 'draw-streak-pre': (player.s1fpw == player.fragsperwar), 'down-streak-pre': (player.s1fpw < player.fragsperwar)}">{{ player.s1fpw }}</div>

                    <div class="season-wars" *ngIf="isInfo" [ngClass]="{'up-streak-post': (player.s1fpw < player.fragsperwar), 'draw-streak-post': (player.s1fpw == player.fragsperwar), 'down-streak-post': (player.s1fpw > player.fragsperwar)}"> <span title="Total FpW">({{ player.fragsperwar }})</span></div>
                  </div> -->
                  <div class="item item-block wars">
                    <div title="Season played wars">{{ player.s4wars }}</div>
                    <div class="season-wars" *ngIf="isInfo"> <span title="Total played wars">{{ player.wars }}</span></div>
                  </div>
                  <!-- <div class="item-block">
                    <div title="Season played wars" >{{ player.s1wars }}</div>
                    <div class="season-wars" *ngIf="isInfo"> <span title="Total played wars">({{ player.wars }})</span></div>
                  </div> -->
                  <div class="item new">{{ player.lastWarDate }}</div>
                  <div class="item name act">
                    <div class="act-month" [attr.data-activity]="player.activity" [style.background]="getActivityGradient(player.activity)" title="{{ player.activity }} wars in last month."></div>
                    <div class="act-year" [attr.data-activity]="player.lastyear" [ngClass]="{
                      'green0': player.lastyear == 0, 
                      'green1_5': (player.lastyear > 0 && player.lastyear <= 30), 'green6_10': (player.lastyear > 30 && player.lastyear <= 90), 'green11_20': (player.lastyear > 90 && player.lastyear <= 150), 'green21_40': (player.lastyear > 150 && player.lastyear <= 250), 'green41_70': (player.lastyear > 250 && player.lastyear <= 365), 'green71': (player.lastyear > 365) }" title="{{ player.lastyear }} wars in last year."></div>
                  </div>              
                </div>
                <!-- <div class="player-seasons" [ngClass]="{'expanded': expandedPlayerIndexes.includes(i)}">
                  <div class="seasons">
                    <div class="season" *ngIf="player.s1ranking_win > 0">
                      <span>Rank in season 1:</span> <span class="rank">{{ player.s1ranking_win }}</span>
                    </div>
                    <div class="season" *ngIf="player.s2ranking_win > 0">
                      <span>Rank in season 2</span> <span class="rank">{{ player.s2ranking_win }}</span>
                    </div>
                  </div>
                  <app-player-view [playerDetail]="player.username" [expanded]="expandedPlayerIndexes.includes(i)"></app-player-view>
                </div> -->
              <!-- </ng-container>   -->
            </ng-container>
          </div> 
          <div class="more-less">
            <form action="">
              <label for="infoChange">{{ isInfo == true ? 'Hide total info' : 'Show total info' }}</label>
              <select class="info-select" name="infoChange" id="" (ngModelChange)="infoChange($event)" [(ngModel)]="infoCode">
                <option value="" disabled selected>Choose a state</option>                           
                <option class="language-select" *ngFor="let item of infos" [ngValue]='item.infoCode'>
                  {{ item.infoName }}
                </option>
              </select>
            </form>
          </div>
          <!-- <div class="info">
            <div class="info-title">NEW FEATURE</div>
            <div class="info-desc">
              Now u can sort people by Wars, Frags per War or Ranking.
            </div>
          </div>     -->
        </div>       
      </div>
      <div class="container-bottom">
        <!-- <div class="legend">
          <div class="cyan"></div>
          <div class="cyan-info">- 
            {{ 'ranking.meeting' | translate }} 
            <a href="https://discord.com/channels/716723661909786690/716723662337605663/1029825546747646093">More info in topic on DISCORD</a>
            </div>
        </div> -->
        <div class="legend">
          <div class="name">           
            <div class="green0"></div>
            <span>0</span>
          </div>          
          <div class="name">            
            <div class="green1_5"></div>
            <span>1 - 5</span>
          </div>                    
          <div class="name">            
            <div class="green6_10"></div>
            <span>6 - 10</span>
          </div>                    
          <div class="name">         
            <div class="green11_20"></div>
            <span>11 - 20</span>
          </div>                    
          <div class="name">           
            <div class="green21_40"></div>
            <span>21 - 40</span>
          </div>                    
          <div class="name">            
            <div class="green41_70"></div>
            <span>41 - 60</span>
          </div>                    
          <div class="name">            
            <div class="green71"></div>
            <span>61+</span>
          </div> 
          <div>wars in last month.</div>                   
        </div>
        <div class="legend legend-year">
          <div class="name">           
            <div class="green0"></div>
            <span>0</span>
          </div>          
          <div class="name">            
            <div class="green1_5"></div>
            <span>1 - 30</span>
          </div>                    
          <div class="name">            
            <div class="green6_10"></div>
            <span>31 - 90</span>
          </div>                    
          <div class="name">         
            <div class="green11_20"></div>
            <span>91 - 150</span>
          </div>                    
          <div class="name">           
            <div class="green21_40"></div>
            <span>151 - 250</span>
          </div>                    
          <div class="name">            
            <div class="green41_70"></div>
            <span>251 - 365</span>
          </div>                    
          <div class="name">            
            <div class="green71"></div>
            <span>365+</span>
          </div> 
          <div>wars in last year.</div>                   
        </div>
        <!-- <div class="legend" *ngIf="isInfo">
          <h3>Expirience ranking</h3>          
          <div class="name">100 - 499 <div class="brown bar-legend"></div></div>
          <div class="name">500 - 999 <div class="silver bar-legend"></div></div>
          <div class="name">+1000 <div class="gold bar-legend"></div></div>
        </div> -->
      </div>
      <div class="container">
        <div class="big-name">Season #4</div> 
      </div>
      <div class="floating-icon-container">
        <div class="floating-icon" [ngClass]="{ 'expanded': isExpanded }" (click)="togglePanel('first')">
          <fa-icon [icon]="trophy"></fa-icon>
        </div>
      
        <div class="floating-icon" [ngClass]="{ 'expanded': isSecondPanelExpanded }" (click)="togglePanel('second')">
          <fa-icon [icon]="chartSimple"></fa-icon>
        </div>
      
        <div class="floating-icon" [ngClass]="{ 'expanded': isThirdPanelExpanded }" (click)="togglePanel('third')">
          <fa-icon [icon]="chartGantt"></fa-icon>
        </div>
      </div>
      
      <div class="floating-panel first-panel" [ngClass]="{ 'expanded': isExpanded }">
        <div class="content">        
          <h2>Winners of seasons</h2>
          <h3>Season 3 (01.07.2023-30.09.2023)</h3>
          <ol>
            <li>
              <a routerLink="/obj-ranking/zielony" class="gold">lolandiusz<img [src]='"assets/images/flags_svg/PL.SVG"'><span>1,175.40</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/Cronic" class="silver">^Cronic<img [src]='"assets/images/flags_svg/BE.SVG"'><span>1,132.29</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/boogie" class="bronze">booGie<img [src]='"assets/images/flags_svg/PL.SVG"'><span>1,127.91</span></a>
            </li>
          </ol>
          <hr>
          <h3>Season 2 (01.04.2023-30.06.2023)</h3>
          <ol>
            <li>
              <a routerLink="/obj-ranking/zazuuuu" class="gold">ZaZUUUU<img [src]='"assets/images/flags_svg/NL.SVG"'><span>1,190.49</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/josh" class="silver">josh<img [src]='"assets/images/flags_svg/UK.SVG"'><span>1,166.85</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/magz" class="bronze">MGZ<img [src]='"assets/images/flags_svg/NL.SVG"'><span>1,151.45</span></a>
            </li>
          </ol>
          <hr>
          <h3>Season 1 (01.01.2023-31.03.2023)</h3>
          <ol>
            <li>
              <a routerLink="/obj-ranking/evoltnz" class="gold">evoltnz<img [src]='"assets/images/flags_svg/GR.SVG"'><span>1,405.28</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/tricky" class="silver">tricky<img [src]='"assets/images/flags_svg/UK.SVG"'><span>1,289.96</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/zielony" class="bronze">lolandiusz<img [src]='"assets/images/flags_svg/PL.SVG"'><span>1,286.88</span></a>
            </li>
          </ol>
        </div>
      </div>
      
      <div class="floating-panel second-panel" [ngClass]="{ 'expanded': isSecondPanelExpanded }">
        <div class="content">
          <!-- Zawartość drugiego panelu -->
          <ul>
            <li>Second Panel Element 1</li>
            <li>Second Panel Element 2</li>
            <!-- Dodaj więcej elementów -->
          </ul>
        </div>
      </div>
      
      <div class="floating-panel third-panel" [ngClass]="{ 'expanded': isThirdPanelExpanded }">
        <div class="content">
          <!-- Zawartość trzeciego panelu -->
          <ul>
            <li>Third Panel Element 1</li>
            <li>Third Panel Element 2</li>
            <!-- Dodaj więcej elementów -->
          </ul>
        </div>
      </div>
      
      <!-- <div class="floating-icon" [ngClass]="{ 'expanded': isExpanded }" (click)="togglePanel()">
        <fa-icon [icon]="trophy"></fa-icon>
        <div class="winners">Winners of seasons by rank</div>
      </div>
      <div class="floating-panel" [ngClass]="{ 'expanded': isExpanded }">
        <div class="content">        
          <h2>Winners of seasons</h2>
          <h3>Season 3 (01.07.2023-30.09.2023)</h3>
          <ol>
            <li>
              <a routerLink="/obj-ranking/zielony" class="gold">lolandiusz<img [src]='"assets/images/flags_svg/PL.SVG"'><span>1,175.40</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/Cronic" class="silver">^Cronic<img [src]='"assets/images/flags_svg/BE.SVG"'><span>1,132.29</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/boogie" class="bronze">booGie<img [src]='"assets/images/flags_svg/PL.SVG"'><span>1,127.91</span></a>
            </li>
          </ol>
          <hr>
          <h3>Season 2 (01.04.2023-30.06.2023)</h3>
          <ol>
            <li>
              <a routerLink="/obj-ranking/zazuuuu" class="gold">ZaZUUUU<img [src]='"assets/images/flags_svg/NL.SVG"'><span>1,190.49</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/josh" class="silver">josh<img [src]='"assets/images/flags_svg/UK.SVG"'><span>1,166.85</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/magz" class="bronze">MGZ<img [src]='"assets/images/flags_svg/NL.SVG"'><span>1,151.45</span></a>
            </li>
          </ol>
          <hr>
          <h3>Season 1 (01.01.2023-31.03.2023)</h3>
          <ol>
            <li>
              <a routerLink="/obj-ranking/evoltnz" class="gold">evoltnz<img [src]='"assets/images/flags_svg/GR.SVG"'><span>1,405.28</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/tricky" class="silver">tricky<img [src]='"assets/images/flags_svg/UK.SVG"'><span>1,289.96</span></a>
            </li>
            <li>
              <a routerLink="/obj-ranking/zielony" class="bronze">lolandiusz<img [src]='"assets/images/flags_svg/PL.SVG"'><span>1,286.88</span></a>
            </li>
          </ol>
        </div>
      </div> -->
      
    </section>
  </ng-container>
</ng-container>
<ng-http-loader 
    [backdrop]="false"
    [backgroundColor]="'#010141'"
    [debounceDelay]="100"
    [extraDuration]="300"
    [minDuration]="300"
    [opacity]=".6"
    [backdropBackgroundColor]="'#777777'"
    [spinner]="spinkit.skWave">
</ng-http-loader>

<!-- <router-outlet></router-outlet> -->